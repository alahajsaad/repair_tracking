import{j as e,y as i}from"./index-yGwYt6Nq.js";import{u as b,s as g}from"./index-DPb_3Eze.js";import{u as j,a as P,E as A,P as I,C as S,b as T,A as v,c as E}from"./hooks-BR9cMY9c.js";import{C as o,a as l}from"./Card-v3_dQfcZ.js";import{B as u}from"./Button-nvBNfKxG.js";import"./label-wM3WakGA.js";import"./index-CIc1txwD.js";import"./index-Y2e7ilkQ.js";import"./index-D4j-s7ve.js";import"./request-DFzFQ-HD.js";import"./user-Bd4vM0qs.js";import"./Input-BljE3152.js";import"./map-pin-DejgNk_T.js";import"./useMutation-B29Hiwaj.js";const H=()=>{const{mutate:p,isPending:N}=j(),{mutate:x,isPending:h}=P(),m=N||h,s=b({resolver:g(E),defaultValues:{entityType:"PERSON",phoneNumbers:[{number:""}],addresses:[{streetAddress:"",city:""}],basicInfo:{firstName:"",lastName:""}}}),c=s.watch("entityType"),y=r=>{s.setValue("entityType",r),r==="PERSON"?s.setValue("basicInfo",{firstName:"",lastName:""}):s.setValue("basicInfo",{companyName:"",registrationNumber:"",taxNumber:""})},d=()=>{s.reset({entityType:"PERSON",phoneNumbers:[{number:""}],addresses:[{streetAddress:"",city:""}],basicInfo:{firstName:"",lastName:""}})},f=async r=>{let t;if(r.entityType==="PERSON"){const n=r.basicInfo;t={partnerType:"CLIENT",entityType:"PERSON",phoneNumbers:r.phoneNumbers,addresses:r.addresses,firstName:n.firstName,lastName:n.lastName},p(t,{onSuccess:a=>{i.success(a.message),d()},onError:a=>{i.error(a.message)}})}else{const n=r.basicInfo;t={partnerType:"CLIENT",entityType:"ORGANIZATION",phoneNumbers:r.phoneNumbers,addresses:r.addresses,companyName:n.companyName,registrationNumber:n.registrationNumber,taxNumber:n.taxNumber},x(t,{onSuccess:a=>{i.success(a.message),d()},onError:a=>{i.error(a.message)}})}console.log("Form data to submit:",t)};return e.jsxs("div",{className:"container mx-auto px-4 py-6 max-w-7xl",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Ajouter un nouveau client"})}),e.jsxs("form",{onSubmit:s.handleSubmit(f),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsx("div",{className:"lg:col-span-4",children:e.jsx(o,{className:"h-full",children:e.jsx(l,{children:e.jsx(A,{value:c,onChange:y})})})}),e.jsx("div",{className:"lg:col-span-8",children:e.jsx(o,{className:"h-full",children:e.jsx(l,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Informations de base"}),c==="PERSON"?e.jsx(I,{form:s}):e.jsx(S,{form:s})]})})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{children:e.jsx(o,{className:"h-full",children:e.jsx(l,{children:e.jsx(T,{form:s})})})}),e.jsx("div",{children:e.jsx(o,{className:"h-full",children:e.jsx(l,{children:e.jsx(v,{form:s})})})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-4 pt-6 border-t border-gray-200",children:[e.jsx(u,{type:"button",onClick:d,disabled:m,className:"w-full sm:w-auto order-2 sm:order-1",children:"Annuler"}),e.jsx(u,{type:"submit",disabled:m,className:"w-full sm:w-auto order-1 sm:order-2",children:m?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Ajout en cours..."]}):"Ajouter client"})]})]})]})};export{H as default};
