import{r as c,j as e,W as C,y as u}from"./index-yGwYt6Nq.js";import{z as a,u as I,s as w}from"./index-DPb_3Eze.js";import{S as E}from"./hook-BZgDK58P.js";import{S as R,L as D}from"./SelectMachine-D9Gk3HJn.js";import{B as F}from"./Button-nvBNfKxG.js";import{C as x,a as h}from"./card-Cp2UR_co.js";import{c as A,d as L}from"./hooks-DhN4L3JL.js";import"./SearchInput-BCy2dsEd.js";import"./Input-BljE3152.js";import"./utils-B63l6kq4.js";import"./hooks-D8JWOBQf.js";import"./useQuery-wnBeM4WK.js";import"./api-CwCx7HfZ.js";import"./request-DFzFQ-HD.js";import"./useMutation-B29Hiwaj.js";import"./api-Dtxjj7pN.js";import"./index-EgUFrByA.js";import"./index-D4j-s7ve.js";import"./index-CIc1txwD.js";import"./index-Y2e7ilkQ.js";const k=a.object({customerComplaint:a.string().min(1,"Designation is required"),partnerId:a.coerce.number().min(1,"Sélectionner un client"),machineId:a.coerce.number().min(1,"Sélectionner une machine")}),ee=()=>{const{register:i,handleSubmit:j,setValue:n,reset:g,formState:{errors:t,isSubmitting:d}}=I({resolver:w(k)}),[r,l]=c.useState(),{data:o,refetch:b}=A(),{mutate:f}=L(),N=new Date,p=c.useId();c.useEffect(()=>{r!=null&&r.id&&n("partnerId",r==null?void 0:r.id,{shouldValidate:!0,shouldDirty:!0})},[r,n]);const y=s=>{n("machineId",s)},S=s=>{if(o&&r){const v={callNumber:o,customerComplaint:s.customerComplaint,machine:{id:s.machineId}};f(v,{onSuccess(m){l(void 0),u.success(m.message),b(),g()},onError:m=>{u.error(`Erreur lors de la création: ${m.message}`)}})}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-2xl border border-blue-100",children:[e.jsx("div",{className:"flex-shrink-0 p-3 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg transform hover:scale-105 transition-transform duration-200",children:e.jsx(C,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:"Ajouter une Réparation"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Créer une nouvelle entrée de réparation dans le système"})]})]}),e.jsx(x,{className:"w-full shadow-sm border py-0",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Numéro d'appel"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:o})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Date"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:N.toLocaleDateString("fr-FR")})]})]})})}),e.jsx(x,{className:"mt-5",children:e.jsx(h,{children:e.jsxs("form",{className:"space-y-5 pt-3",onSubmit:j(S),children:[e.jsxs("div",{children:[e.jsx(E,{label:"Rechercher un client",partner:r,setPartner:l,partnerType:"CLIENT"}),e.jsx("input",{type:"hidden",...i("partnerId")}),t.partnerId&&e.jsx("p",{className:"text-red-500",children:t.partnerId.message})]}),e.jsxs("div",{children:[e.jsx(R,{partner:r,onSelect:y}),e.jsx("input",{type:"hidden",...i("machineId")}),t.machineId&&e.jsx("p",{className:"text-red-500",children:t.machineId.message})]}),e.jsxs("div",{children:[e.jsx(D,{id:p,children:"Decrire le problem de cette machine"}),e.jsx("textarea",{id:p,className:"bg-gray-50 border p-2.5 border-gray-300  text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full",...i("customerComplaint")}),t.customerComplaint&&e.jsx("p",{className:"text-red-500",children:t.customerComplaint.message})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(F,{type:"submit",disabled:d,children:d?"En cours...":"Ajouter"})})]})})})]})};export{ee as default,k as formSchema};
